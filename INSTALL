
*** Инсталяция Web-сервера

curl https://raw.github.com/kriszyp/cpm/master/install | CPM_INSTALL_LIB=~/lib CPM_INSTALL_BIN=~/bin sh
~/devel/Observer/root/static/js $ cpm install dgrid

*** Инталяция обходчика на серверах мониторинга

Для независимой установки программы от системы создаем нового
пользователя, и все дальнейшие действия выполняем от его имени.
Устанавливаем приоритет поиска исполняемых файлов в $HOME/bin в
начало очереди (редактируем профили командных оболочек).

Устанавливаем перл. Если в процессе установки модулей возникнут ошибки
нужно попробовать установить более свежую версию perl.

wget http://www.cpan.org/src/5.0/perl-5.16.2.tar.gz
tar -xzf perl-5.16.2.tar.gz
cd perl-5.16.2
./Configure -sde -Duseithreads -Doptimize="-O2 -fomit-frame-pointer -pipe" \
    -Duseshrplib -Ui_malloc -Ui_iconv -Uinstallusrbinperl -Dprefix=$HOME
make
make test
make install
perl --version
cpan inc::Module::Install

Устанавливаем обходчик в корневой пользовательский каталог
cd
export CVSROOT=:pserver:anoncvs@cvs.yalta.net.ua/root
cvs co Observer
cd Observer

cp -f Makefile.PL-walker Makefile.PL
perl Makefile.PL
make installdeps
В случае возникновения ошибок пробуем установить сбойный модуль из cpan
используя команды force и notest.

Проверяем работоспособность обходчика. Если, при выполнении, возникли
ошибки из-за отсутствия модуля, необходимо с CPAN загрузить недостающие
модули perl и повторить операцию.
./script/observer_snmpwalker.pl -v

Справка:
./script/observer_snmpwalker.pl -h

Выполняем конфигурацию.

cp observer.conf.default observer.conf
Открываем observer.conf и вносим изменения в следующие строки:
dsn             dbi:mysql:observer;host=observer-db.domain
user            *****
password        *****
area_host somearea-1.domain

Остальные параметры могут изменяться в зависимости от характера нагрузки на
обходчик и оборудования по которому необходимов выполнять сбор информации.

Запускаем обходчик в тестовом режиме (выход по ^C) и проверяем его работу
из вебинтерфейса основного сервера Observer путем создания нового устройства
в данной зоне обслуживания (area).
./script/observer_snmpwalker.pl -f

Если все успешно, добавляем обходчик в запуск системы.

...

Для дальнейшего обновления конфигурационного файла в случае обновления ПО
создаем отпечаток изменений конфигурации коммандой:
./script/update_config.sh init observer.conf

*** Обновление

В случае обновления ПО основного сервера (вебсервера) с изменениями, которые
коснулись обходчика, необходимо на всех серверах мониторинга обновить обходчик.
Заходим в каталог обходчика и обновляем его из репозитория до актуальной
версии:
cd Observer
cvs update

Для внесения изменений в текущий конфигурационный файл после обновления ПО
вызываем команду:
./script/update_config.sh update

Если во время выполнения комманды ошибок не произошло, заменям конфигурационный
файл на обновленный:
mv -f observer.conf~ observer.conf

Перезапускаем обходчик для вступления изменений в силу.
